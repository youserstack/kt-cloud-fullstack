<main>
  <section
    class="max-w-screen-lg min-h-screen mx-auto border border-dashed p-4"
  >
    <div class="border border-dashed">
      <h1 class="text-4xl font-bold">{{title}}</h1>

      {{! 검색, 글쓰기 버튼 }}
      <div class="mt-[40px] flex items-center gap-4">
        <div class="flex gap-2 border rounded-md px-2 py-1">
          <input
            type="text"
            name="search"
            id="search"
            value="{{search}}"
            {{! 검색어가 있으면 입력창에 표시 }}
            placeholder="검색어를 입력하세요."
          />
          <button
            onclick="location.href=`/?search=${document.getElementById('search').value}`"
            class="bg-zinc-100 hover:bg-zinc-200 px-2 py-1 rounded-sm text-sm"
          >검색</button>
        </div>
        <a href="/write">글쓰기</a>
      </div>

      {{! 게시글 리스트 }}
      <div class="rounded-md border mt-[50px]">
        <table class="w-full text-sm text-left">
          <thead class="text-xs text-gray-700 uppercase bg-gray-50">
            <tr class="border-b">
              <th scope="col" class="px-6 py-3 w-1/2">제목</th>
              <th scope="col" class="px-6 py-3 text-center">작성자</th>
              <th scope="col" class="px-6 py-3 text-center">조회수</th>
              <th scope="col" class="px-6 py-3 text-center">등록일</th>
            </tr>
          </thead>
          <tbody>
            {{! posts 배열을 순회하며 각 게시글 정보를 출력합니다. }}
            {{#each posts}}
              <tr class="bg-white border-b hover:bg-gray-50">
                <td
                  class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap"
                >
                  <a
                    href="/detail/{{_id}}"
                    class="hover:underline"
                  >{{title}}</a>
                </td>
                <td class="px-6 py-4 text-center">{{writer}}</td>
                <td class="px-6 py-4 text-center">{{hits}}</td>
                <td class="px-6 py-4 text-center">{{dateString createdAt}}</td>
              </tr>
            {{/each}}
          </tbody>
        </table>
      </div>

      {{! 페이지네이션 }}
      <nav class="mt-8 flex justify-center">
        {{! paginator 객체가 있을 경우에만 내부 블록을 렌더링합니다. }}
        {{#with paginator}}
          <ul class="flex items-center -space-x-px h-10 text-base">
            {{! 이전 페이지로 이동 }}
            <li>
              {{#if hasPrev}}
                <a
                  href="/?page={{prevPage}}&search={{@root.search}}"
                  class="flex items-center justify-center px-4 h-10 ms-0 leading-tight text-gray-500 bg-white border border-e-0 border-gray-300 rounded-s-lg hover:bg-gray-100 hover:text-gray-700"
                >
                  <span class="sr-only">Previous</span>
                  &lt;
                </a>
              {{else}}
                <span
                  class="flex items-center justify-center px-4 h-10 ms-0 leading-tight text-gray-500 bg-white border border-e-0 border-gray-300 rounded-s-lg cursor-not-allowed opacity-50"
                >&lt;</span>
              {{/if}}
            </li>

            {{! 페이지 번호 목록을 순회합니다. }}
            {{#each pageList}}
              <li>
                {{! 현재 페이지와 번호가 같으면 활성화 스타일을 적용합니다. }}
                {{#if (eq this @root.paginator.page)}}
                  <span
                    aria-current="page"
                    class="z-10 flex items-center justify-center px-4 h-10 leading-tight text-blue-600 border border-blue-300 bg-blue-50"
                  >{{this}}</span>
                {{else}}
                  {{! 다른 페이지는 해당 페이지로 이동하는 링크를 생성합니다. }}
                  <a
                    href="/?page={{this}}&search={{@root.search}}"
                    class="flex items-center justify-center px-4 h-10 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700"
                  >{{this}}</a>
                {{/if}}
              </li>
            {{/each}}

            {{! 다음 페이지로 이동 }}
            <li>
              {{#if hasNext}}
                <a
                  href="/?page={{nextPage}}&search={{@root.search}}"
                  class="flex items-center justify-center px-4 h-10 leading-tight text-gray-500 bg-white border border-gray-300 rounded-e-lg hover:bg-gray-100 hover:text-gray-700"
                >
                  <span class="sr-only">Next</span>
                  &gt;
                </a>
              {{else}}
                <span
                  class="flex items-center justify-center px-4 h-10 leading-tight text-gray-500 bg-white border border-gray-300 rounded-e-lg cursor-not-allowed opacity-50"
                >&gt;</span>
              {{/if}}
            </li>
          </ul>
        {{/with}}
      </nav>
    </div>
  </section>

</main>